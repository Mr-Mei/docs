<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.62">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" href="/images/logo.svg"><title>vue3 开发技巧 | 编程宝典</title><meta name="description" content="小书生的笔记文档">
    <link rel="preload" href="/assets/style-c0f6d13d.css" as="style"><link rel="stylesheet" href="/assets/style-c0f6d13d.css">
    <link rel="modulepreload" href="/assets/app-8b451bf5.js"><link rel="modulepreload" href="/assets/Vue3开发技巧.html-585af8f3.js"><link rel="modulepreload" href="/assets/Vue3开发技巧.html-ae566fe9.js"><link rel="prefetch" href="/assets/index.html-d83b2f87.js" as="script"><link rel="prefetch" href="/assets/NodeJs目录.html-90d5a520.js" as="script"><link rel="prefetch" href="/assets/Python目录.html-daf7e9d9.js" as="script"><link rel="prefetch" href="/assets/前端目录.html-4fe9d80d.js" as="script"><link rel="prefetch" href="/assets/学习路线.html-8100a5f9.js" as="script"><link rel="prefetch" href="/assets/index.html-c68c696a.js" as="script"><link rel="prefetch" href="/assets/CSS基础.html-1dd3728d.js" as="script"><link rel="prefetch" href="/assets/CSS常用技巧.html-7e9f9967.js" as="script"><link rel="prefetch" href="/assets/CSS目录.html-984c1b73.js" as="script"><link rel="prefetch" href="/assets/GraceUI目录.html-6f86e5ff.js" as="script"><link rel="prefetch" href="/assets/HTML5基础知识总结.html-53b3c250.js" as="script"><link rel="prefetch" href="/assets/HTML5语义化.html-bbcffb3e.js" as="script"><link rel="prefetch" href="/assets/HTML基础.html-34aee152.js" as="script"><link rel="prefetch" href="/assets/HTML目录.html-89b9d554.js" as="script"><link rel="prefetch" href="/assets/常用布局方案.html-18c8ae6d.js" as="script"><link rel="prefetch" href="/assets/JS基础.html-a03825d2.js" as="script"><link rel="prefetch" href="/assets/JS对浏览器URL的操作.html-058763d4.js" as="script"><link rel="prefetch" href="/assets/JS常用方法.html-f96ce5ce.js" as="script"><link rel="prefetch" href="/assets/JS构造函数详解.html-26ead34c.js" as="script"><link rel="prefetch" href="/assets/JS目录.html-d41fa99d.js" as="script"><link rel="prefetch" href="/assets/JTemplate.html-64c626f8.js" as="script"><link rel="prefetch" href="/assets/JTemplate语法.html-8321bf90.js" as="script"><link rel="prefetch" href="/assets/React目录.html-2b9d175c.js" as="script"><link rel="prefetch" href="/assets/Uniapp目录.html-4cf7c76b.js" as="script"><link rel="prefetch" href="/assets/Vue2基础知识.html-65038031.js" as="script"><link rel="prefetch" href="/assets/Vue3常用知识点总结.html-179c5c83.js" as="script"><link rel="prefetch" href="/assets/Vue目录.html-18f67bc4.js" as="script"><link rel="prefetch" href="/assets/GitHub个人令牌创建.html-9a667ce2.js" as="script"><link rel="prefetch" href="/assets/Git常用命令大全.html-876c0117.js" as="script"><link rel="prefetch" href="/assets/其他目录.html-786e173d.js" as="script"><link rel="prefetch" href="/assets/小程序目录.html-2eb8e05d.js" as="script"><link rel="prefetch" href="/assets/404.html-f9875e7b.js" as="script"><link rel="prefetch" href="/assets/index.html-ddf80fd7.js" as="script"><link rel="prefetch" href="/assets/NodeJs目录.html-bc7ebac2.js" as="script"><link rel="prefetch" href="/assets/Python目录.html-6dd356fd.js" as="script"><link rel="prefetch" href="/assets/前端目录.html-395dea47.js" as="script"><link rel="prefetch" href="/assets/学习路线.html-0ad2ad74.js" as="script"><link rel="prefetch" href="/assets/index.html-02c09ab1.js" as="script"><link rel="prefetch" href="/assets/CSS基础.html-0d069223.js" as="script"><link rel="prefetch" href="/assets/CSS常用技巧.html-187f3e39.js" as="script"><link rel="prefetch" href="/assets/CSS目录.html-547fe008.js" as="script"><link rel="prefetch" href="/assets/GraceUI目录.html-291e5da0.js" as="script"><link rel="prefetch" href="/assets/HTML5基础知识总结.html-8255dbdc.js" as="script"><link rel="prefetch" href="/assets/HTML5语义化.html-4cd78fa4.js" as="script"><link rel="prefetch" href="/assets/HTML基础.html-700304a2.js" as="script"><link rel="prefetch" href="/assets/HTML目录.html-9bf27a88.js" as="script"><link rel="prefetch" href="/assets/常用布局方案.html-3a4cb9fa.js" as="script"><link rel="prefetch" href="/assets/JS基础.html-d6a1afed.js" as="script"><link rel="prefetch" href="/assets/JS对浏览器URL的操作.html-c139ad62.js" as="script"><link rel="prefetch" href="/assets/JS常用方法.html-264af5ca.js" as="script"><link rel="prefetch" href="/assets/JS构造函数详解.html-dc6307cc.js" as="script"><link rel="prefetch" href="/assets/JS目录.html-8d4b3cf8.js" as="script"><link rel="prefetch" href="/assets/JTemplate.html-dc72f0c2.js" as="script"><link rel="prefetch" href="/assets/JTemplate语法.html-09c88e67.js" as="script"><link rel="prefetch" href="/assets/React目录.html-7d92686b.js" as="script"><link rel="prefetch" href="/assets/Uniapp目录.html-3609cb5f.js" as="script"><link rel="prefetch" href="/assets/Vue2基础知识.html-81643e3b.js" as="script"><link rel="prefetch" href="/assets/Vue3常用知识点总结.html-ca457dbb.js" as="script"><link rel="prefetch" href="/assets/Vue目录.html-7c77c739.js" as="script"><link rel="prefetch" href="/assets/GitHub个人令牌创建.html-fe6f5784.js" as="script"><link rel="prefetch" href="/assets/Git常用命令大全.html-7d23c77f.js" as="script"><link rel="prefetch" href="/assets/其他目录.html-6b275acf.js" as="script"><link rel="prefetch" href="/assets/小程序目录.html-5af1a728.js" as="script"><link rel="prefetch" href="/assets/404.html-1dbe02b9.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><img class="logo" src="/images/logo.svg" alt="编程宝典"><span class="site-name can-hide">编程宝典</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/前端/前端目录.md" class="" aria-label="前端"><!--[--><!--]--> 前端 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/NodeJs/NodeJs目录.md" class="" aria-label="NodeJs"><!--[--><!--]--> NodeJs <!--[--><!--]--></a></div><div class="navbar-item"><a href="/Python/Python目录.md" class="" aria-label="Python"><!--[--><!--]--> Python <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://www.cnblogs.com/meijifu/" rel="noopener noreferrer" target="_blank" aria-label="博客园"><!--[--><!--]--> 博客园 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/Mr-Mei" rel="noopener noreferrer" target="_blank" aria-label="github"><!--[--><!--]--> github <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://gitee.com/Mr-May" rel="noopener noreferrer" target="_blank" aria-label="gitee"><!--[--><!--]--> gitee <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/前端/前端目录.md" class="" aria-label="前端"><!--[--><!--]--> 前端 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/NodeJs/NodeJs目录.md" class="" aria-label="NodeJs"><!--[--><!--]--> NodeJs <!--[--><!--]--></a></div><div class="navbar-item"><a href="/Python/Python目录.md" class="" aria-label="Python"><!--[--><!--]--> Python <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://www.cnblogs.com/meijifu/" rel="noopener noreferrer" target="_blank" aria-label="博客园"><!--[--><!--]--> 博客园 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/Mr-Mei" rel="noopener noreferrer" target="_blank" aria-label="github"><!--[--><!--]--> github <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://gitee.com/Mr-May" rel="noopener noreferrer" target="_blank" aria-label="gitee"><!--[--><!--]--> gitee <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><a href="/" class="sidebar-item sidebar-heading" aria-label="编程宝典"><!--[--><!--]--> 编程宝典 <!--[--><!--]--></a><!----></li><li><a href="/%E7%9B%AE%E5%BD%95/" class="sidebar-item sidebar-heading" aria-label="目录"><!--[--><!--]--> 目录 <!--[--><!--]--></a><!----></li><li><p tabindex="0" class="sidebar-item sidebar-heading active collapsible">前端 <span class="down arrow"></span></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/%E5%89%8D%E7%AB%AF/%E5%89%8D%E7%AB%AF%E7%9B%AE%E5%BD%95.html" class="sidebar-item" aria-label="前端目录"><!--[--><!--]--> 前端目录 <!--[--><!--]--></a><!----></li><li><p tabindex="0" class="sidebar-item collapsible">HTML <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/%E5%89%8D%E7%AB%AF/HTML/HTML%E7%9B%AE%E5%BD%95.html" class="sidebar-item" aria-label="HTML目录"><!--[--><!--]--> HTML目录 <!--[--><!--]--></a><!----></li><li><a href="/%E5%89%8D%E7%AB%AF/HTML/HTML%E5%9F%BA%E7%A1%80.html" class="sidebar-item" aria-label="HTML基础"><!--[--><!--]--> HTML基础 <!--[--><!--]--></a><!----></li><li><a href="/%E5%89%8D%E7%AB%AF/HTML/HTML5%E8%AF%AD%E4%B9%89%E5%8C%96.html" class="sidebar-item" aria-label="HTML5语义化"><!--[--><!--]--> HTML5语义化 <!--[--><!--]--></a><!----></li><li><a href="/%E5%89%8D%E7%AB%AF/HTML/HTML5%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93.html" class="sidebar-item" aria-label="HTML5 基础知识总结"><!--[--><!--]--> HTML5 基础知识总结 <!--[--><!--]--></a><!----></li><li><a href="/%E5%89%8D%E7%AB%AF/HTML/%E5%B8%B8%E7%94%A8%E5%B8%83%E5%B1%80%E6%96%B9%E6%A1%88.html" class="sidebar-item" aria-label="常用布局方案"><!--[--><!--]--> 常用布局方案 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item collapsible">CSS <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/%E5%89%8D%E7%AB%AF/CSS/CSS%E7%9B%AE%E5%BD%95.html" class="sidebar-item" aria-label="CSS目录"><!--[--><!--]--> CSS目录 <!--[--><!--]--></a><!----></li><li><a href="/%E5%89%8D%E7%AB%AF/CSS/CSS%E5%9F%BA%E7%A1%80.html" class="sidebar-item" aria-label="CSS基础"><!--[--><!--]--> CSS基础 <!--[--><!--]--></a><!----></li><li><a href="/%E5%89%8D%E7%AB%AF/CSS/CSS%E5%B8%B8%E7%94%A8%E6%8A%80%E5%B7%A7.html" class="sidebar-item" aria-label="CSS常用技巧"><!--[--><!--]--> CSS常用技巧 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item collapsible">JS <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/%E5%89%8D%E7%AB%AF/JS/JS%E7%9B%AE%E5%BD%95.html" class="sidebar-item" aria-label="JS目录"><!--[--><!--]--> JS目录 <!--[--><!--]--></a><!----></li><li><a href="/%E5%89%8D%E7%AB%AF/JS/JS%E5%9F%BA%E7%A1%80.html" class="sidebar-item" aria-label="JS基础"><!--[--><!--]--> JS基础 <!--[--><!--]--></a><!----></li><li><a href="/%E5%89%8D%E7%AB%AF/JS/JS%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E8%AF%A6%E8%A7%A3.html" class="sidebar-item" aria-label="JS构造函数详解"><!--[--><!--]--> JS构造函数详解 <!--[--><!--]--></a><!----></li><li><a href="/%E5%89%8D%E7%AB%AF/JS/JS%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95.html" class="sidebar-item" aria-label="JS常用方法"><!--[--><!--]--> JS常用方法 <!--[--><!--]--></a><!----></li><li><a href="/%E5%89%8D%E7%AB%AF/JS/JS%E5%AF%B9%E6%B5%8F%E8%A7%88%E5%99%A8URL%E7%9A%84%E6%93%8D%E4%BD%9C.html" class="sidebar-item" aria-label="JS对浏览器URL的操作"><!--[--><!--]--> JS对浏览器URL的操作 <!--[--><!--]--></a><!----></li><li><a href="/%E5%89%8D%E7%AB%AF/JS/JTemplate%E8%AF%AD%E6%B3%95.html" class="sidebar-item" aria-label="JTemplate语法"><!--[--><!--]--> JTemplate语法 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item active collapsible">Vue <span class="down arrow"></span></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/%E5%89%8D%E7%AB%AF/Vue/Vue%E7%9B%AE%E5%BD%95.html" class="sidebar-item" aria-label="Vue目录"><!--[--><!--]--> Vue目录 <!--[--><!--]--></a><!----></li><li><a href="/%E5%89%8D%E7%AB%AF/Vue/Vue2%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html" class="sidebar-item" aria-label="Vue2 基础知识"><!--[--><!--]--> Vue2 基础知识 <!--[--><!--]--></a><!----></li><li><a href="/%E5%89%8D%E7%AB%AF/Vue/Vue3%E5%B8%B8%E7%94%A8%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.html" class="sidebar-item" aria-label="Vue3 常用知识点总结"><!--[--><!--]--> Vue3 常用知识点总结 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/%E5%89%8D%E7%AB%AF/Vue/Vue3%E5%BC%80%E5%8F%91%E6%8A%80%E5%B7%A7.html" class="router-link-active router-link-exact-active router-link-active sidebar-item active" aria-label="vue3 开发技巧"><!--[--><!--]--> vue3 开发技巧 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/%E5%89%8D%E7%AB%AF/Vue/Vue3%E5%BC%80%E5%8F%91%E6%8A%80%E5%B7%A7.html#_1-善用h-createvnode-和render-函数" class="router-link-active router-link-exact-active sidebar-item" aria-label="1. 善用h（createVNode）和render 函数"><!--[--><!--]--> 1. 善用h（createVNode）和render 函数 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/%E5%89%8D%E7%AB%AF/Vue/Vue3%E5%BC%80%E5%8F%91%E6%8A%80%E5%B7%A7.html#_2-善用jsx-tsx" class="router-link-active router-link-exact-active sidebar-item" aria-label="2. 善用JSX/TSX"><!--[--><!--]--> 2. 善用JSX/TSX <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/%E5%89%8D%E7%AB%AF/Vue/Vue3%E5%BC%80%E5%8F%91%E6%8A%80%E5%B7%A7.html#jsx和模板语法的优势对比" class="router-link-active router-link-exact-active sidebar-item" aria-label="jsx和模板语法的优势对比"><!--[--><!--]--> jsx和模板语法的优势对比 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/%E5%89%8D%E7%AB%AF/Vue/Vue3%E5%BC%80%E5%8F%91%E6%8A%80%E5%B7%A7.html#什么是jsx" class="router-link-active router-link-exact-active sidebar-item" aria-label="什么是JSX"><!--[--><!--]--> 什么是JSX <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/%E5%89%8D%E7%AB%AF/Vue/Vue3%E5%BC%80%E5%8F%91%E6%8A%80%E5%B7%A7.html#模板语法的优势" class="router-link-active router-link-exact-active sidebar-item" aria-label="模板语法的优势"><!--[--><!--]--> 模板语法的优势 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/%E5%89%8D%E7%AB%AF/Vue/Vue3%E5%BC%80%E5%8F%91%E6%8A%80%E5%B7%A7.html#jsx的优势" class="router-link-active router-link-exact-active sidebar-item" aria-label="JSX的优势"><!--[--><!--]--> JSX的优势 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/%E5%89%8D%E7%AB%AF/Vue/Vue3%E5%BC%80%E5%8F%91%E6%8A%80%E5%B7%A7.html#_3-善用依赖注入-provide-inject" class="router-link-active router-link-exact-active sidebar-item" aria-label="3. 善用依赖注入（Provide / Inject）"><!--[--><!--]--> 3. 善用依赖注入（Provide / Inject） <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/%E5%89%8D%E7%AB%AF/Vue/Vue3%E5%BC%80%E5%8F%91%E6%8A%80%E5%B7%A7.html#ioc-和di-是什么" class="router-link-active router-link-exact-active sidebar-item" aria-label="IOC 和DI 是什么"><!--[--><!--]--> IOC 和DI 是什么 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/%E5%89%8D%E7%AB%AF/Vue/Vue3%E5%BC%80%E5%8F%91%E6%8A%80%E5%B7%A7.html#什么是依赖注入" class="router-link-active router-link-exact-active sidebar-item" aria-label="什么是依赖注入"><!--[--><!--]--> 什么是依赖注入 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/%E5%89%8D%E7%AB%AF/Vue/Vue3%E5%BC%80%E5%8F%91%E6%8A%80%E5%B7%A7.html#vue中的依赖注入" class="router-link-active router-link-exact-active sidebar-item" aria-label="vue中的依赖注入"><!--[--><!--]--> vue中的依赖注入 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/%E5%89%8D%E7%AB%AF/Vue/Vue3%E5%BC%80%E5%8F%91%E6%8A%80%E5%B7%A7.html#基本用法" class="router-link-active router-link-exact-active sidebar-item" aria-label="基本用法"><!--[--><!--]--> 基本用法 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/%E5%89%8D%E7%AB%AF/Vue/Vue3%E5%BC%80%E5%8F%91%E6%8A%80%E5%B7%A7.html#_4-善用composition-api抽离通用逻辑" class="router-link-active router-link-exact-active sidebar-item" aria-label="4. 善用Composition API抽离通用逻辑"><!--[--><!--]--> 4. 善用Composition API抽离通用逻辑 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/%E5%89%8D%E7%AB%AF/Vue/Vue3%E5%BC%80%E5%8F%91%E6%8A%80%E5%B7%A7.html#什么是composition-api" class="router-link-active router-link-exact-active sidebar-item" aria-label="什么是Composition API"><!--[--><!--]--> 什么是Composition API <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/%E5%89%8D%E7%AB%AF/Vue/Vue3%E5%BC%80%E5%8F%91%E6%8A%80%E5%B7%A7.html#基础使用" class="router-link-active router-link-exact-active sidebar-item" aria-label="基础使用"><!--[--><!--]--> 基础使用 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/%E5%89%8D%E7%AB%AF/Vue/Vue3%E5%BC%80%E5%8F%91%E6%8A%80%E5%B7%A7.html#_5-善于使用getcurrentinstance-获取组件实例" class="router-link-active router-link-exact-active sidebar-item" aria-label="5. 善于使用getCurrentInstance 获取组件实例"><!--[--><!--]--> 5. 善于使用getCurrentInstance 获取组件实例 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/%E5%89%8D%E7%AB%AF/Vue/Vue3%E5%BC%80%E5%8F%91%E6%8A%80%E5%B7%A7.html#_6-善用-attrs" class="router-link-active router-link-exact-active sidebar-item" aria-label="6. 善用$attrs"><!--[--><!--]--> 6. 善用$attrs <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/%E5%89%8D%E7%AB%AF/Vue/Vue3%E5%BC%80%E5%8F%91%E6%8A%80%E5%B7%A7.html#_7-优雅注册全局组件技巧" class="router-link-active router-link-exact-active sidebar-item" aria-label="7. 优雅注册全局组件技巧"><!--[--><!--]--> 7. 优雅注册全局组件技巧 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/%E5%89%8D%E7%AB%AF/Vue/Vue3%E5%BC%80%E5%8F%91%E6%8A%80%E5%B7%A7.html#vue-插件注册" class="router-link-active router-link-exact-active sidebar-item" aria-label="vue 插件注册"><!--[--><!--]--> vue 插件注册 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/%E5%89%8D%E7%AB%AF/Vue/Vue3%E5%BC%80%E5%8F%91%E6%8A%80%E5%B7%A7.html#_8-善用-script-setup" class="router-link-active router-link-exact-active sidebar-item" aria-label="8. 善用&lt;/script setup&gt;"><!--[--><!--]--> 8. 善用&lt;/script setup&gt; <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/%E5%89%8D%E7%AB%AF/Vue/Vue3%E5%BC%80%E5%8F%91%E6%8A%80%E5%B7%A7.html#_9-v-model的最新用法" class="router-link-active router-link-exact-active sidebar-item" aria-label="9. v-model的最新用法"><!--[--><!--]--> 9. v-model的最新用法 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item collapsible">React <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/%E5%89%8D%E7%AB%AF/React/React%E7%9B%AE%E5%BD%95.html" class="sidebar-item" aria-label="React目录"><!--[--><!--]--> React目录 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item collapsible">小程序 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/%E5%89%8D%E7%AB%AF/%E5%B0%8F%E7%A8%8B%E5%BA%8F/%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%9B%AE%E5%BD%95.html" class="sidebar-item" aria-label="小程序目录"><!--[--><!--]--> 小程序目录 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item collapsible">Uniapp <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/%E5%89%8D%E7%AB%AF/Uniapp/Uniapp%E7%9B%AE%E5%BD%95.html" class="sidebar-item" aria-label="Uniapp目录"><!--[--><!--]--> Uniapp目录 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item collapsible">GraceUI <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/%E5%89%8D%E7%AB%AF/GraceUI/GraceUI%E7%9B%AE%E5%BD%95.html" class="sidebar-item" aria-label="GraceUI目录"><!--[--><!--]--> GraceUI目录 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item collapsible">其他 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/%E5%89%8D%E7%AB%AF/%E5%85%B6%E4%BB%96/%E5%85%B6%E4%BB%96%E7%9B%AE%E5%BD%95.html" class="sidebar-item" aria-label="其他目录"><!--[--><!--]--> 其他目录 <!--[--><!--]--></a><!----></li><li><a href="/%E5%89%8D%E7%AB%AF/%E5%85%B6%E4%BB%96/GitHub%E4%B8%AA%E4%BA%BA%E4%BB%A4%E7%89%8C%E5%88%9B%E5%BB%BA.html" class="sidebar-item" aria-label="GitHub 个人令牌创建"><!--[--><!--]--> GitHub 个人令牌创建 <!--[--><!--]--></a><!----></li><li><a href="/%E5%89%8D%E7%AB%AF/%E5%85%B6%E4%BB%96/Git%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E5%A4%A7%E5%85%A8.html" class="sidebar-item" aria-label="Git 常用命令大全"><!--[--><!--]--> Git 常用命令大全 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a href="/%E5%89%8D%E7%AB%AF/%E5%AD%A6%E4%B9%A0%E8%B7%AF%E7%BA%BF.html" class="sidebar-item" aria-label="前端学习路线"><!--[--><!--]--> 前端学习路线 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">NodeJs <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/NodeJs/NodeJs%E7%9B%AE%E5%BD%95.html" class="sidebar-item" aria-label="NodeJs目录"><!--[--><!--]--> NodeJs目录 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">Python <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/Python/Python%E7%9B%AE%E5%BD%95.html" class="sidebar-item" aria-label="python目录"><!--[--><!--]--> python目录 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="vue3-开发技巧" tabindex="-1"><a class="header-anchor" href="#vue3-开发技巧" aria-hidden="true">#</a> vue3 开发技巧</h1><h2 id="_1-善用h-createvnode-和render-函数" tabindex="-1"><a class="header-anchor" href="#_1-善用h-createvnode-和render-函数" aria-hidden="true">#</a> 1. 善用h（createVNode）和render 函数</h2><p>我们知道在vue3中导出了一个神奇的createVNode 函数 当前函数它能创建一个vdom，大家不要小看vdom， 我们好好利用它，就能做出意想不到的效果<code>比如我们要实现一个弹窗组件</code>，我们通常的思路是写一个组件在项目中引用进来，通过v-model来控制他的显示隐藏，但是这样有个问题，我们复用的时候的成本需要复制粘贴。我们没有办法来提高效率，比如封装成 npm 通过调用js来使用。然而，有了 createVNode 和render 之后，所有问题就不是问题了。</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// 我们可以将弹窗组件封装为一个方法，放到任何想放的地方</span>
<span class="token comment">// 我们先写一个弹窗组件</span>
<span class="token keyword">const</span> message <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> num <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
            num
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">template</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;div&gt;
                  &lt;div&gt;{{num}}&lt;/div&gt;
                  &lt;div&gt;这是一个弹窗&lt;/div&gt;
              &lt;/div&gt;</span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span>

<span class="token comment">// 初始化组件生成vdom</span>
<span class="token keyword">const</span> vm <span class="token operator">=</span> <span class="token function">createVNode</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span>
<span class="token comment">// 创建容器，也可以用已经存在的</span>
<span class="token keyword">const</span> container <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&#39;div&#39;</span><span class="token punctuation">)</span>
<span class="token comment">//render通过patch 变成dom</span>
<span class="token function">render</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> container<span class="token punctuation">)</span>
<span class="token comment">// 弹窗挂到任何你想去的地方  </span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>container<span class="token punctuation">.</span>firstElementChild<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-善用jsx-tsx" tabindex="-1"><a class="header-anchor" href="#_2-善用jsx-tsx" aria-hidden="true">#</a> 2. 善用JSX/TSX</h2><p>文档上说了，在绝大多数情况下，Vue 推荐使用模板语法来搭建 HTML。然而在某些使用场景下，我们真的需要用到 JavaScript 完全的编程能力。这时<code>渲染函数</code>就派上用场了。</p><h3 id="jsx和模板语法的优势对比" tabindex="-1"><a class="header-anchor" href="#jsx和模板语法的优势对比" aria-hidden="true">#</a> jsx和模板语法的优势对比</h3><p>jsx和模板语法都是vue 支持的的书写范畴，然后他们确有不同的使用场景，和方式，需要我们根据当前组件的实际情况，来酌情使用</p><h3 id="什么是jsx" tabindex="-1"><a class="header-anchor" href="#什么是jsx" aria-hidden="true">#</a> 什么是JSX</h3><p><code>JSX</code> 是一种 Javascript 的语法扩展，JSX = Javascript + XML，即在 Javascript 里面写 XML，因为 JSX 的这个特性，所以他即具备了 Javascript 的灵活性，同时又兼具 html 的<code>语义化和直观性</code>。</p><h3 id="模板语法的优势" tabindex="-1"><a class="header-anchor" href="#模板语法的优势" aria-hidden="true">#</a> 模板语法的优势</h3><ul><li>1、模板语法书写起来不怎么违和，我们就像在写html一样</li><li>2、在vue3中由于模板的可遍历性，它能在编译阶段做更多优化，比如静态标记、块block、缓存事件处理程序等</li><li>3、模板代码逻辑代码严格分开，可读性高</li><li>4、对JS功底不那么好的人，记几个命令就能快速开发，上手简单</li><li>5、vue官方插件的完美支持，代码格式化，语法高亮等</li></ul><h3 id="jsx的优势" tabindex="-1"><a class="header-anchor" href="#jsx的优势" aria-hidden="true">#</a> JSX的优势</h3><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token number">1</span>、灵活、灵活、灵活（重要的事情说三遍）
<span class="token number">2</span>、一个文件能写好多个组件
<span class="token number">3</span>、只要<span class="token constant">JS</span>功底好，就不用记忆那么多命令，上来就是一通输出
<span class="token number">4</span>、<span class="token constant">JS</span>和<span class="token constant">JSX</span>混用，方法即声明即用，对于懂行的人来说逻辑清晰
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>我们知道组件类型，分为<strong>容器型组件</strong>和<strong>展示型组件</strong> 在一般情况下，容器型组件，他由于可能要对于当前展示型组件做一个标准化或者宰包装，那么此时容器型组件中用JSX就再好不过</p><p>举个例子：现在有个需求，我们有两个按钮，现在要做一个通过后台数据来选择展示哪一个按钮，我们通常的做法，<code>是通过在一个模板中通过v-if去控制不同的组件</code>，然而有了JSX与函数式组件之后，我们发现逻辑更清晰了，代码更简洁了，质量更高了</p><div class="language-vue line-numbers-mode" data-ext="vue"><pre class="language-vue"><code>//btn1.vue
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    这是btn1{{ num }}
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> ref<span class="token punctuation">,</span> defineComponent <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineComponent</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;btn1&#39;</span><span class="token punctuation">,</span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> num <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span> num <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
//btn2.vue
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    这是btn2{{ num }}
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">import</span> <span class="token punctuation">{</span> ref<span class="token punctuation">,</span> defineComponent <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span>
    <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineComponent</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;btn2&#39;</span><span class="token punctuation">,</span>
        <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> num <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token punctuation">{</span> num <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>用JSX配合函数式组件来做一个容器组件</p><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token comment">// 容器组件</span>
<span class="token keyword">import</span> btn1 <span class="token keyword">from</span> <span class="token string">&#39;./btn1.vue&#39;</span>
<span class="token keyword">import</span> btn2 <span class="token keyword">from</span> <span class="token string">&#39;./btn2.vue&#39;</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">renderFn</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">props<span class="token punctuation">,</span> context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> props<span class="token punctuation">.</span>type <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">?</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>btn1</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>context<span class="token punctuation">.</span>slots<span class="token punctuation">.</span><span class="token function">default</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>btn1</span><span class="token punctuation">&gt;</span></span> <span class="token operator">:</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>btn2</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>context<span class="token punctuation">.</span>slots<span class="token punctuation">.</span><span class="token function">default</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>btn2</span><span class="token punctuation">&gt;</span></span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>引入业务组件</p><div class="language-vue line-numbers-mode" data-ext="vue"><pre class="language-vue"><code>//业务组件
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>renderFn</span> <span class="token attr-name">:type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>1111111<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>renderFn</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> renderFn <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./components&#39;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>renderFn<span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">components</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        renderFn
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-善用依赖注入-provide-inject" tabindex="-1"><a class="header-anchor" href="#_3-善用依赖注入-provide-inject" aria-hidden="true">#</a> 3. 善用依赖注入（Provide / Inject）</h2><p>先来了解一些概念，帮助我们更全面的了解依赖注入的前世今生。</p><h3 id="ioc-和di-是什么" tabindex="-1"><a class="header-anchor" href="#ioc-和di-是什么" aria-hidden="true">#</a> IOC 和DI 是什么</h3><p><strong>控制反转</strong>（Inversion of Control，缩写为<strong>IOC</strong>），是面向对象编程中的一种设计原则，可以用来减低计算机代码之间的耦合度。其中最常见的方式叫做<strong>依赖注入</strong>（Dependency Injection，简称<strong>DI</strong>），还有一种方式叫“依赖查找”（Dependency Lookup）。通过控制反转，对象在被创建的时候，由一个调控系统内所有对象的外界实体，将其所依赖的对象的引用传递(注入)给它。</p><h3 id="什么是依赖注入" tabindex="-1"><a class="header-anchor" href="#什么是依赖注入" aria-hidden="true">#</a> 什么是依赖注入</h3><p><strong>依赖注入</strong> 大白话：就是将实例变量传入到一个对象中去</p><h3 id="vue中的依赖注入" tabindex="-1"><a class="header-anchor" href="#vue中的依赖注入" aria-hidden="true">#</a> vue中的依赖注入</h3><p>在vue中，我们套用依赖注入的概念，<code>其实就是在父组件中声明依赖，将他们注入到子孙组件实例中去</code>，可以说是能够很大程度上代替<code>全局状态管理</code>的存在</p><p><img src="/images/Vue/vue中的依赖注入.png" alt="e71533f1bc81491e924a394f0afccfe1.png"></p><h3 id="基本用法" tabindex="-1"><a class="header-anchor" href="#基本用法" aria-hidden="true">#</a> 基本用法</h3><p>父组件中声明provide</p><div class="language-vue line-numbers-mode" data-ext="vue"><pre class="language-vue"><code>//parent.vue
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>count++<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>添加<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">import</span> <span class="token punctuation">{</span> provide<span class="token punctuation">,</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> count <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">provide</span><span class="token punctuation">(</span><span class="token string">&#39;count&#39;</span><span class="token punctuation">,</span> count<span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>子组件中注入inject</p><div class="language-vue line-numbers-mode" data-ext="vue"><pre class="language-vue"><code>//child.vue
//使用inject 注入
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>这是注入的内容{{ count }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">import</span> <span class="token punctuation">{</span> inject <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> count <span class="token operator">=</span> <span class="token function">inject</span><span class="token punctuation">(</span><span class="token string">&#39;count&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-善用composition-api抽离通用逻辑" tabindex="-1"><a class="header-anchor" href="#_4-善用composition-api抽离通用逻辑" aria-hidden="true">#</a> 4. 善用Composition API抽离通用逻辑</h2><p>众所周知，vue3最大的新特性，当属<code>Composition API</code> 也叫组合api ，用好了他，就能提高你在行业的竞争力。</p><h3 id="什么是composition-api" tabindex="-1"><a class="header-anchor" href="#什么是composition-api" aria-hidden="true">#</a> 什么是Composition API</h3><p>使用 (<code>data</code>、<code>computed</code>、<code>methods</code>、<code>watch</code>) 组件选项来组织逻辑通常都很有效。然而，当我们的组件开始变得更大时，<strong>逻辑关注点</strong>的列表也会增长。尤其对于那些一开始没有编写这些组件的人来说，这会导致组件难以阅读和理解。于是在vue3中为了解决当前痛点，避免在大型项目中出现代码逻辑分散，散落在当前组件的各个角落，从而变得难以维护，Composition API横空出世，所谓<code>Composition API</code> 就是在组件配置对象中声明 <code>setup</code>函数，我们可以将所有的逻辑封装在<code>setup</code>函数中，然后在配合vue3中提供的响应式API 钩子函数、计算属性API等，我们就能达到和常规的<code>选项式</code>同样的效果，但是却拥有更清晰的代码以及<code>逻辑层面的复用</code></p><h3 id="基础使用" tabindex="-1"><a class="header-anchor" href="#基础使用" aria-hidden="true">#</a> 基础使用</h3><div class="language-vue line-numbers-mode" data-ext="vue"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>composition<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>测试compositionApi<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> inject<span class="token punctuation">,</span> ref<span class="token punctuation">,</span> onMounted<span class="token punctuation">,</span> computed<span class="token punctuation">,</span> watch <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    <span class="token comment">// setup起手</span>
    <span class="token function">setup</span><span class="token punctuation">(</span><span class="token parameter">props<span class="token punctuation">,</span> <span class="token punctuation">{</span> attrs<span class="token punctuation">,</span> emit<span class="token punctuation">,</span> slots<span class="token punctuation">,</span> expose <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 
        <span class="token comment">// 获取页面元素</span>
        <span class="token keyword">const</span> composition <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
        <span class="token comment">// 依赖注入</span>
        <span class="token keyword">const</span> count <span class="token operator">=</span> <span class="token function">inject</span><span class="token punctuation">(</span><span class="token string">&#39;foo&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;1&#39;</span><span class="token punctuation">)</span>
        <span class="token comment">// 响应式结合</span>
        <span class="token keyword">const</span> num <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token comment">//钩子函数</span>
        <span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;这是个钩子&#39;</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token comment">// 计算属性</span>
        <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> num<span class="token punctuation">.</span>value <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token comment">// 监听值的变化</span>
        <span class="token function">watch</span><span class="token punctuation">(</span>count<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">count<span class="token punctuation">,</span> prevCount</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;这个值变了&#39;</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
            num<span class="token punctuation">,</span>
            count
        <span class="token punctuation">}</span>
 
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>通过以上代码我们可以看出，一个setup函数我们干出了在<code>传统选项式</code>中的所有事情，然而这还不是最绝的，通过这些api的组合可以实现逻辑复用，这样我们就能封装很多通用逻辑，实现复用，提高工作效率。</p><p>举个例子：大家都用过复制剪贴板的功能，在通常情况下，利用navigator.clipboard.writeText 方法就能将复制内容写入剪切板。然而，细心的你会发现，其实赋值剪切板他是一个通用功能，比如：你做b端业务的，管理系统中到处充满了复制id、复制文案等功能。</p><p>于是<code>Composition API</code>的逻辑复用能力就派上了用场</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> watch<span class="token punctuation">,</span> getCurrentScope<span class="token punctuation">,</span> onScopeDispose<span class="token punctuation">,</span> unref<span class="token punctuation">,</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">isString</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">typeof</span> val <span class="token operator">===</span> <span class="token string">&#39;string&#39;</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">noop</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">unrefElement</span><span class="token punctuation">(</span><span class="token parameter">elRef</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> plain <span class="token operator">=</span> <span class="token function">unref</span><span class="token punctuation">(</span>elRef<span class="token punctuation">)</span><span class="token comment">// 拿到本来的值</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>plain<span class="token punctuation">)</span><span class="token punctuation">.</span>$el <span class="token operator">??</span> plain <span class="token comment">// 前面的值为null、undefined，则取后面的值，否则都取前面的值</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">tryOnScopeDispose</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 如果有活跃的effect</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">getCurrentScope</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 在当前活跃的 effect 作用域上注册一个处理回调。该回调会在相关的 effect 作用域结束之后被调用</span>
        <span class="token comment">// 能代替onUmounted</span>
        <span class="token function">onScopeDispose</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>
<span class="token comment">// 带有控件的setTimeout包装器。</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">useTimeoutFn</span><span class="token punctuation">(</span>
    cb<span class="token punctuation">,</span><span class="token comment">// 回调</span>
    interval<span class="token punctuation">,</span><span class="token comment">// 时间</span>
    options <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span>
        immediate <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span> <span class="token operator">=</span> options
 
    <span class="token keyword">const</span> isPending <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
 
    <span class="token keyword">let</span> timer
 
    <span class="token keyword">function</span> <span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>timer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span>
            timer <span class="token operator">=</span> <span class="token keyword">null</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
 
    <span class="token keyword">function</span> <span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        isPending<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">false</span>
        <span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
 
    <span class="token keyword">function</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 清除上一次定时器</span>
        <span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment">// 是否在pending 状态</span>
        isPending<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">true</span>
        <span class="token comment">// 重新启动定时器</span>
        timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// 当定时器执行的时候结束pending状态</span>
            isPending<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">false</span>
            <span class="token comment">// 初始化定时器的id</span>
            timer <span class="token operator">=</span> <span class="token keyword">null</span>
            <span class="token comment">// 执行回调</span>
            <span class="token function">cb</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token function">unref</span><span class="token punctuation">(</span>interval<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>immediate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        isPending<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">true</span>
 
        <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
 
    <span class="token function">tryOnScopeDispose</span><span class="token punctuation">(</span>stop<span class="token punctuation">)</span>
 
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        isPending<span class="token punctuation">,</span>
        start<span class="token punctuation">,</span>
        stop<span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 轻松使用EventListener。安装时使用addEventListener注册，卸载时自动移除EventListener。</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">useEventListener</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> target
    <span class="token keyword">let</span> event
    <span class="token keyword">let</span> listener
    <span class="token keyword">let</span> options
    <span class="token comment">// 如果第一个参数是否是字符串</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isString</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//结构内容</span>
        <span class="token punctuation">[</span>event<span class="token punctuation">,</span> listener<span class="token punctuation">,</span> options<span class="token punctuation">]</span> <span class="token operator">=</span> args
        target <span class="token operator">=</span> window
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token punctuation">[</span>target<span class="token punctuation">,</span> event<span class="token punctuation">,</span> listener<span class="token punctuation">,</span> options<span class="token punctuation">]</span> <span class="token operator">=</span> args
    <span class="token punctuation">}</span>
    <span class="token keyword">let</span> cleanup <span class="token operator">=</span> noop
    <span class="token keyword">const</span> stopWatch <span class="token operator">=</span> <span class="token function">watch</span><span class="token punctuation">(</span>
        <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">unrefElement</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment">// 监听dom</span>
        <span class="token punctuation">(</span><span class="token parameter">el</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token function">cleanup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 执行默认函数</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>el<span class="token punctuation">)</span>
                <span class="token keyword">return</span>
            <span class="token comment">// 绑定事件el如果没有传入就绑定为window</span>
            el<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>event<span class="token punctuation">,</span> listener<span class="token punctuation">,</span> options<span class="token punctuation">)</span>
            <span class="token comment">// 重写函数方便改变的时候卸载</span>
            <span class="token function-variable function">cleanup</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                el<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span>event<span class="token punctuation">,</span> listener<span class="token punctuation">,</span> options<span class="token punctuation">)</span>
                cleanup <span class="token operator">=</span> noop
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token comment">// flush: &#39;post&#39; 模板引用侦听</span>
        <span class="token punctuation">{</span> <span class="token literal-property property">immediate</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token literal-property property">flush</span><span class="token operator">:</span> <span class="token string">&#39;post&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
    <span class="token comment">// 卸载</span>
    <span class="token keyword">const</span> <span class="token function-variable function">stop</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">stopWatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token function">cleanup</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
 
    <span class="token function">tryOnScopeDispose</span><span class="token punctuation">(</span>stop<span class="token punctuation">)</span>
 
    <span class="token keyword">return</span> stop
<span class="token punctuation">}</span>
 
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">useClipboard</span><span class="token punctuation">(</span><span class="token parameter">options <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//获取配置</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span>
        navigator <span class="token operator">=</span> window<span class="token punctuation">.</span>navigator<span class="token punctuation">,</span>
        read <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        source<span class="token punctuation">,</span>
        copiedDuring <span class="token operator">=</span> <span class="token number">1500</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span> <span class="token operator">=</span> options
    <span class="token comment">// 事件类型</span>
    <span class="token keyword">const</span> events <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;copy&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;cut&#39;</span><span class="token punctuation">]</span>
    <span class="token comment">// 判断当前浏览器知否支持clipboard</span>
    <span class="token keyword">const</span> isSupported <span class="token operator">=</span> <span class="token function">Boolean</span><span class="token punctuation">(</span>navigator <span class="token operator">&amp;&amp;</span> <span class="token string">&#39;clipboard&#39;</span> <span class="token keyword">in</span> navigator<span class="token punctuation">)</span>
    <span class="token comment">// 导出的text</span>
    <span class="token keyword">const</span> text <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">&#39;&#39;</span><span class="token punctuation">)</span>
    <span class="token comment">// 导出的copied</span>
    <span class="token keyword">const</span> copied <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
    <span class="token comment">// 使用的的定时器钩子</span>
    <span class="token keyword">const</span> timeout <span class="token operator">=</span> <span class="token function">useTimeoutFn</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> copied<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">,</span> copiedDuring<span class="token punctuation">)</span>
 
    <span class="token keyword">function</span> <span class="token function">updateText</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//解析系统剪贴板的文本内容返回一个Promise</span>
        navigator<span class="token punctuation">.</span>clipboard<span class="token punctuation">.</span><span class="token function">readText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            text<span class="token punctuation">.</span>value <span class="token operator">=</span> value
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
 
    <span class="token keyword">if</span> <span class="token punctuation">(</span>isSupported <span class="token operator">&amp;&amp;</span> read<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 绑定事件</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> event <span class="token keyword">of</span> events<span class="token punctuation">)</span>
            <span class="token function">useEventListener</span><span class="token punctuation">(</span>event<span class="token punctuation">,</span> updateText<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 复制剪切板方法</span>
    <span class="token comment">// navigator.clipboard.writeText 方法是异步的返回一个promise</span>
    <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">copy</span><span class="token punctuation">(</span><span class="token parameter">value <span class="token operator">=</span> <span class="token function">unref</span><span class="token punctuation">(</span>source<span class="token punctuation">)</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>isSupported <span class="token operator">&amp;&amp;</span> value <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">await</span> navigator<span class="token punctuation">.</span>clipboard<span class="token punctuation">.</span><span class="token function">writeText</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
            <span class="token comment">// 响应式的值，方便外部能动态获取</span>
            text<span class="token punctuation">.</span>value <span class="token operator">=</span> value
            copied<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">true</span>
            timeout<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">// copied.value = false </span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
 
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        isSupported<span class="token punctuation">,</span>
        text<span class="token punctuation">,</span>
        copied<span class="token punctuation">,</span>
        copy<span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这时我们就复用了复制的逻辑，如下代码中直接引入在模板中使用即可</p><div class="language-vue line-numbers-mode" data-ext="vue"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>isSupported<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>code</span><span class="token punctuation">&gt;</span></span>{{ text || &#39;空&#39; }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>code</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>input<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>copy(input)<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>!copied<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>复制<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">v-else</span><span class="token punctuation">&gt;</span></span>复制中!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">v-else</span><span class="token punctuation">&gt;</span></span>您的浏览器不支持剪贴板API<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">import</span> <span class="token punctuation">{</span> ref<span class="token punctuation">,</span> getCurrentScope <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span>
    <span class="token keyword">import</span> <span class="token punctuation">{</span> useClipboard <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./copy.js&#39;</span>
    <span class="token keyword">const</span> input <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">&#39;&#39;</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> text<span class="token punctuation">,</span> isSupported<span class="token punctuation">,</span> copied<span class="token punctuation">,</span> copy <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useClipboard</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token comment">// 复制内容</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>isSupported<span class="token punctuation">)</span><span class="token comment">// 是否支持复制剪切板api </span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>copied<span class="token punctuation">)</span><span class="token comment">// 是否复制完成延迟</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>copy<span class="token punctuation">)</span> <span class="token comment">// 复制方法</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_5-善于使用getcurrentinstance-获取组件实例" tabindex="-1"><a class="header-anchor" href="#_5-善于使用getcurrentinstance-获取组件实例" aria-hidden="true">#</a> 5. 善于使用getCurrentInstance 获取组件实例</h2><p><code>getCurrentInstance</code> 支持访问内部组件实例, 通常情况下他被放在 setup中获取组件实例，但是 <code>getCurrentInstance</code> 只暴露给高阶使用场景，典型的比如在库中。强烈反对在应用的代码中使用 <code>getCurrentInstance</code>。请<strong>不要</strong>把它当作在组合式 API 中获取 <code>this</code> 的替代方案来使用。</p><p>他的作用是<strong>逻辑提取</strong>，用来代替Mixin，这是在复杂组件中，为了整个代码的可维护性，抽取通用逻辑这是必须要去做的事情，我们可以看element-plus 中table的复用逻辑，在逻辑提取中由于涉及获取<code>props、proxy、emit</code> 以及能通过当前组件获取父子组件的关系等，此时<code>getCurrentInstance</code>的作用无可代替，如<code>element-plus</code>代码中利用 getCurrentInstance 获取父组件<code>parent</code>中的数据，分别保存到不同的变量中，我们只需要调用当前useMapState即可拿到数据</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// 保存数据的逻辑封装</span>
<span class="token keyword">function</span> useMapState<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> instance <span class="token operator">=</span> <span class="token function">getCurrentInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> table <span class="token operator">=</span> instance<span class="token punctuation">.</span>parent <span class="token keyword">as</span> Table<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span>
  <span class="token keyword">const</span> store <span class="token operator">=</span> table<span class="token punctuation">.</span>store
  <span class="token keyword">const</span> leftFixedLeafCount <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> store<span class="token punctuation">.</span>states<span class="token punctuation">.</span>fixedLeafColumnsLength<span class="token punctuation">.</span>value
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> rightFixedLeafCount <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> store<span class="token punctuation">.</span>states<span class="token punctuation">.</span>rightFixedColumns<span class="token punctuation">.</span>value<span class="token punctuation">.</span>length
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> columnsCount <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> store<span class="token punctuation">.</span>states<span class="token punctuation">.</span>columns<span class="token punctuation">.</span>value<span class="token punctuation">.</span>length
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> leftFixedCount <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> store<span class="token punctuation">.</span>states<span class="token punctuation">.</span>fixedColumns<span class="token punctuation">.</span>value<span class="token punctuation">.</span>length
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> rightFixedCount <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> store<span class="token punctuation">.</span>states<span class="token punctuation">.</span>rightFixedColumns<span class="token punctuation">.</span>value<span class="token punctuation">.</span>length
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
 
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    leftFixedLeafCount<span class="token punctuation">,</span>
    rightFixedLeafCount<span class="token punctuation">,</span>
    columnsCount<span class="token punctuation">,</span>
    leftFixedCount<span class="token punctuation">,</span>
    rightFixedCount<span class="token punctuation">,</span>
    <span class="token literal-property property">columns</span><span class="token operator">:</span> store<span class="token punctuation">.</span>states<span class="token punctuation">.</span>columns<span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_6-善用-attrs" tabindex="-1"><a class="header-anchor" href="#_6-善用-attrs" aria-hidden="true">#</a> 6. 善用$attrs</h2><p><code>$attrs</code> 现在包含了_所有_传递给组件的 attribute，包括 <code>class</code> 和 <code>style</code>。</p><p>通过他，我们可以做组件的<code>事件以及props</code>透传</p><p>首先有一个标准化的组件，一般是组件库的组件等等</p><div class="language-vue line-numbers-mode" data-ext="vue"><pre class="language-vue"><code>//child.vue
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>这是一个标准化组件<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>num<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@input</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>setInput<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> defineComponent <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">;</span>
 
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineComponent</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;num&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">emits</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;edit&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token function">setup</span><span class="token punctuation">(</span><span class="token parameter">props<span class="token punctuation">,</span> <span class="token punctuation">{</span> emit <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">function</span> <span class="token function">setInput</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">&#39;edit&#39;</span><span class="token punctuation">,</span> val<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
            setInput
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>接下来有一个包装组件，他对当前的标准化组件做修饰，从而使结果变成我们符合我们的预期的组件</p><div class="language-vue line-numbers-mode" data-ext="vue"><pre class="language-vue"><code>//parent.vue
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>这一层要做一个单独的包装<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>child</span> <span class="token attr-name">v-bind</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$attrs<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@edit</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>edit<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>child</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> defineComponent <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> child <span class="token keyword">from</span> <span class="token string">&#39;./child.vue&#39;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineComponent</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">components</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        child
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">setup</span><span class="token punctuation">(</span><span class="token parameter">props<span class="token punctuation">,</span> <span class="token punctuation">{</span> emit <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">function</span> <span class="token function">edit</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 对返回的值做一个包装</span>
            <span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">&#39;edit&#39;</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>val<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">time</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
            edit
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>我们发现当前包装组件中使用了<code>$attrs</code>，通过他透传给标准化组件，这样一来，我们就能对比如element UI中的组件做增强以及包装处理，并且不用改动原组件的逻辑。</p><h2 id="_7-优雅注册全局组件技巧" tabindex="-1"><a class="header-anchor" href="#_7-优雅注册全局组件技巧" aria-hidden="true">#</a> 7. 优雅注册全局组件技巧</h2><p>vue3的组件通常情况下使用vue提供的<code>component</code> 方法来完成全局组件的注册</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> app <span class="token operator">=</span> Vue<span class="token punctuation">.</span><span class="token function">createApp</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
 
app<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">&#39;component-a&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token comment">/* ... */</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">&#39;component-b&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token comment">/* ... */</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">&#39;component-c&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token comment">/* ... */</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
 
app<span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">&#39;#app&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>使用时</p><div class="language-vue line-numbers-mode" data-ext="vue"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>app<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>component-a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>component-a</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>component-b</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>component-b</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>component-c</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>component-c</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>然而经过大佬的奇技淫巧的开发，我们发现可能使用注册vue插件的方式，也能完成组件注册，并且是优雅的！</p><h3 id="vue-插件注册" tabindex="-1"><a class="header-anchor" href="#vue-插件注册" aria-hidden="true">#</a> vue 插件注册</h3><p>插件的格式</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">//plugins/index.js</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">install</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">app<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// 这是插件的内容</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>插件的使用</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createApp <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span>
<span class="token keyword">import</span> Plugin <span class="token keyword">from</span> <span class="token string">&#39;./plugins/index.js&#39;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">createApp</span><span class="token punctuation">(</span>Root<span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Plugin<span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">&#39;#app&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>其实插件的本质，就是在use的方法中调用插件中的<code>install方法</code>，那么这样一来，我们就能在<code>install</code>方法中注册组件。</p><p>index.js中抛出一个组件插件</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// index.js</span>
<span class="token keyword">import</span> component <span class="token keyword">from</span> <span class="token string">&#39;./Cmponent.vue&#39;</span>
<span class="token keyword">const</span> component <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">install</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">Vue</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">&#39;component-name&#39;</span><span class="token punctuation">,</span>component<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>  <span class="token comment">// &#39;component-name&#39;这就是后面可以使用的组件的名字，install是默认的一个方法 component-name 是自定义的，我们可以按照具体的需		求自己定义名字</span>
<span class="token punctuation">}</span>
<span class="token comment">// 导出该组件</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> component
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>组件注册</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// 引入组件</span>
<span class="token keyword">import</span> Component <span class="token keyword">from</span> <span class="token string">&#39;./index.js&#39;</span><span class="token punctuation">;</span> 
<span class="token comment">// 全局挂载utils</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Component<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上述案例中，就是一个简单的优雅的组件注册方式，大家可以发现包括<code>element-plus、vant</code> 等组件都是用如此方式注册组件。</p><h2 id="_8-善用-script-setup" tabindex="-1"><a class="header-anchor" href="#_8-善用-script-setup" aria-hidden="true">#</a> 8. 善用&lt;/script setup&gt;</h2><p><code>&lt;script setup&gt;</code>是在单文件组件 (SFC) 中使 的编译时语法糖。相比于普通的 <code>&lt;script&gt;</code>语法，它具有更多优势：</p><ul><li>更少的样板内容，更简洁的代码。</li><li>能够使用纯 Typescript 声明 props 和抛出事件。</li><li>更好的运行时性能 (其模板会被编译成与其同一作用域的渲染函数，没有任何的中间代理)。</li><li>更好的 IDE 类型推断性能 (减少语言服务器从代码中抽离类型的工作)。</li></ul><p>它能代替大多数的setup函数所表达的内容，具体使用方法，大家请看请移步文档</p><p>但是由于setup函数它能返回渲染函数的特性，在当前语法糖中却无法展示，于是遍寻资料，找到了一个折中的办法：</p><div class="language-vue line-numbers-mode" data-ext="vue"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
	<span class="token keyword">import</span> <span class="token punctuation">{</span> ref<span class="token punctuation">,</span>h <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span>
	<span class="token keyword">const</span> msg <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">&#39;Hello World!&#39;</span><span class="token punctuation">)</span>
	<span class="token keyword">const</span> <span class="token function-variable function">dynode</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">&#39;div&#39;</span><span class="token punctuation">,</span>msg<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dynode</span> <span class="token punctuation">/&gt;</span></span>
  	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>msg<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>	
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>如此一来，我们就能在语法糖中返回渲染函数了。</p><h2 id="_9-v-model的最新用法" tabindex="-1"><a class="header-anchor" href="#_9-v-model的最新用法" aria-hidden="true">#</a> 9. v-model的最新用法</h2><p>我们知道在vue2中想要模拟v-model，必须要子组件要接受一个<code>value的props</code> 暴露出来一个 叫<code>input的emit</code>，然而在vue3中他升级了，父组件中使用v-model，如下：</p><div class="language-vue line-numbers-mode" data-ext="vue"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>child</span> <span class="token attr-name"><span class="token namespace">v-model:</span>title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pageTitle<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>child</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> defineComponent<span class="token punctuation">,</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> child <span class="token keyword">from</span> <span class="token string">&#39;./child.vue&#39;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineComponent</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">components</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        child
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">setup</span><span class="token punctuation">(</span><span class="token parameter">props<span class="token punctuation">,</span> <span class="token punctuation">{</span> emit <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> pageTitle <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">&#39;这是v-model&#39;</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
            pageTitle
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>子组件中使用 <code>title的props</code> 以及暴露出<code>update:title的emit</code></p><div class="language-vue line-numbers-mode" data-ext="vue"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>{{ title }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@input</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>setInput<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> defineComponent <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">;</span>
 
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineComponent</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;title&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">emits</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;update:title&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token function">setup</span><span class="token punctuation">(</span><span class="token parameter">props<span class="token punctuation">,</span> <span class="token punctuation">{</span> emit <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">function</span> <span class="token function">setInput</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">&#39;update:title&#39;</span><span class="token punctuation">,</span> val<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
            setInput
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>有了以上语法糖，我们在封装组件的时候，就可以随心所欲了，比如我自己封装可以控制显示隐藏的组件我们就能使用<code>v-model:visible</code>单独控制组件的显示隐藏。使用正常的<code>v-model</code> 控制组件内部的其他逻辑，从而拥有<code>使用更简洁的逻辑，表达相同的功能</code></p></div><!--[--><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: 7531336@qq.com">meijifu</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/%E5%89%8D%E7%AB%AF/Vue/Vue3%E5%B8%B8%E7%94%A8%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.html" class="" aria-label="Vue3 常用知识点总结"><!--[--><!--]--> Vue3 常用知识点总结 <!--[--><!--]--></a></span><!----></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/assets/app-8b451bf5.js" defer></script>
  </body>
</html>
